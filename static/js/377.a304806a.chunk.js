"use strict";(self.webpackChunkaccount_book=self.webpackChunkaccount_book||[]).push([[377],{3377:function(n,t,e){e.r(t),e.d(t,{default:function(){return Ln}});var r=e(168),o=e(885),i=e(208),u=e(2791),c=e(6871),a=e(6095);function f(n){for(var t=arguments.length,e=Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+n+(e.length?" "+e.map((function(n){return"'"+n+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function l(n){return!!n&&!!n[G]}function s(n){return!!n&&(function(n){if(!n||"object"!=typeof n)return!1;var t=Object.getPrototypeOf(n);if(null===t)return!0;var e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return e===Object||"function"==typeof e&&Function.toString.call(e)===Q}(n)||Array.isArray(n)||!!n[X]||!!n.constructor[X]||g(n)||m(n))}function d(n,t,e){void 0===e&&(e=!1),0===h(n)?(e?Object.keys:Y)(n).forEach((function(r){e&&"symbol"==typeof r||t(r,n[r],n)})):n.forEach((function(e,r){return t(r,e,n)}))}function h(n){var t=n[G];return t?t.i>3?t.i-4:t.i:Array.isArray(n)?1:g(n)?2:m(n)?3:0}function p(n,t){return 2===h(n)?n.has(t):Object.prototype.hasOwnProperty.call(n,t)}function v(n,t){return 2===h(n)?n.get(t):n[t]}function b(n,t,e){var r=h(n);2===r?n.set(t,e):3===r?(n.delete(t),n.add(e)):n[t]=e}function y(n,t){return n===t?0!==n||1/n==1/t:n!=n&&t!=t}function g(n){return H&&n instanceof Map}function m(n){return T&&n instanceof Set}function x(n){return n.o||n.t}function w(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var t=nn(n);delete t[G];for(var e=Y(t),r=0;r<e.length;r++){var o=e[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:n[o]})}return Object.create(Object.getPrototypeOf(n),t)}function j(n,t){return void 0===t&&(t=!1),P(n)||l(n)||!s(n)||(h(n)>1&&(n.set=n.add=n.clear=n.delete=k),Object.freeze(n),t&&d(n,(function(n,t){return j(t,!0)}),!0)),n}function k(){f(2)}function P(n){return null==n||"object"!=typeof n||Object.isFrozen(n)}function S(n){var t=tn[n];return t||f(18,n),t}function O(){return U}function Z(n,t){t&&(S("Patches"),n.u=[],n.s=[],n.v=t)}function A(n){C(n),n.p.forEach(D),n.p=null}function C(n){n===U&&(U=n.l)}function z(n){return U={p:[],l:U,h:n,m:!0,_:0}}function D(n){var t=n[G];0===t.i||1===t.i?t.j():t.O=!0}function I(n,t){t._=t.p.length;var e=t.p[0],r=void 0!==n&&n!==e;return t.h.g||S("ES5").S(t,n,r),r?(e[G].P&&(A(t),f(4)),s(n)&&(n=R(t,n),t.l||_(t,n)),t.u&&S("Patches").M(e[G].t,n,t.u,t.s)):n=R(t,e,[]),A(t),t.u&&t.v(t.u,t.s),n!==J?n:void 0}function R(n,t,e){if(P(t))return t;var r=t[G];if(!r)return d(t,(function(o,i){return F(n,r,t,o,i,e)}),!0),t;if(r.A!==n)return t;if(!r.P)return _(n,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=w(r.k):r.o;d(3===r.i?new Set(o):o,(function(t,i){return F(n,r,o,t,i,e)})),_(n,o,!1),e&&n.u&&S("Patches").R(r,e,n.u,n.s)}return r.o}function F(n,t,e,r,o,i){if(l(o)){var u=R(n,o,i&&t&&3!==t.i&&!p(t.D,r)?i.concat(r):void 0);if(b(e,r,u),!l(u))return;n.m=!1}if(s(o)&&!P(o)){if(!n.h.F&&n._<1)return;R(n,o),t&&t.A.l||_(n,o)}}function _(n,t,e){void 0===e&&(e=!1),n.h.F&&n.m&&j(t,e)}function E(n,t){var e=n[G];return(e?x(e):n)[t]}function L(n,t){if(t in n)for(var e=Object.getPrototypeOf(n);e;){var r=Object.getOwnPropertyDescriptor(e,t);if(r)return r;e=Object.getPrototypeOf(e)}}function B(n){n.P||(n.P=!0,n.l&&B(n.l))}function M(n){n.o||(n.o=w(n.t))}function W(n,t,e){var r=g(t)?S("MapSet").N(t,e):m(t)?S("MapSet").T(t,e):n.g?function(n,t){var e=Array.isArray(n),r={i:e?1:0,A:t?t.A:O(),P:!1,I:!1,D:{},l:t,t:n,k:null,o:null,j:null,C:!1},o=r,i=en;e&&(o=[r],i=rn);var u=Proxy.revocable(o,i),c=u.revoke,a=u.proxy;return r.k=a,r.j=c,a}(t,e):S("ES5").J(t,e);return(e?e.A:O()).p.push(r),r}function K(n){return l(n)||f(22,n),function n(t){if(!s(t))return t;var e,r=t[G],o=h(t);if(r){if(!r.P&&(r.i<4||!S("ES5").K(r)))return r.t;r.I=!0,e=N(t,o),r.I=!1}else e=N(t,o);return d(e,(function(t,o){r&&v(r.t,t)===o||b(e,t,n(o))})),3===o?new Set(e):e}(n)}function N(n,t){switch(t){case 2:return new Map(n);case 3:return Array.from(n)}return w(n)}var q,U,V="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),H="undefined"!=typeof Map,T="undefined"!=typeof Set,$="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,J=V?Symbol.for("immer-nothing"):((q={})["immer-nothing"]=!0,q),X=V?Symbol.for("immer-draftable"):"__$immer_draftable",G=V?Symbol.for("immer-state"):"__$immer_state",Q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Y="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,nn=Object.getOwnPropertyDescriptors||function(n){var t={};return Y(n).forEach((function(e){t[e]=Object.getOwnPropertyDescriptor(n,e)})),t},tn={},en={get:function(n,t){if(t===G)return n;var e=x(n);if(!p(e,t))return function(n,t,e){var r,o=L(t,e);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(n.k):void 0}(n,e,t);var r=e[t];return n.I||!s(r)?r:r===E(n.t,t)?(M(n),n.o[t]=W(n.A.h,r,n)):r},has:function(n,t){return t in x(n)},ownKeys:function(n){return Reflect.ownKeys(x(n))},set:function(n,t,e){var r=L(x(n),t);if(null==r?void 0:r.set)return r.set.call(n.k,e),!0;if(!n.P){var o=E(x(n),t),i=null==o?void 0:o[G];if(i&&i.t===e)return n.o[t]=e,n.D[t]=!1,!0;if(y(e,o)&&(void 0!==e||p(n.t,t)))return!0;M(n),B(n)}return n.o[t]===e&&"number"!=typeof e&&(void 0!==e||t in n.o)||(n.o[t]=e,n.D[t]=!0,!0)},deleteProperty:function(n,t){return void 0!==E(n.t,t)||t in n.t?(n.D[t]=!1,M(n),B(n)):delete n.D[t],n.o&&delete n.o[t],!0},getOwnPropertyDescriptor:function(n,t){var e=x(n),r=Reflect.getOwnPropertyDescriptor(e,t);return r?{writable:!0,configurable:1!==n.i||"length"!==t,enumerable:r.enumerable,value:e[t]}:r},defineProperty:function(){f(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){f(12)}},rn={};d(en,(function(n,t){rn[n]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),rn.deleteProperty=function(n,t){return rn.set.call(this,n,t,void 0)},rn.set=function(n,t,e){return en.set.call(this,n[0],t,e,n[0])};var on,un=function(){function n(n){var t=this;this.g=$,this.F=!0,this.produce=function(n,e,r){if("function"==typeof n&&"function"!=typeof e){var o=e;e=n;var i=t;return function(n){var t=this;void 0===n&&(n=o);for(var r=arguments.length,u=Array(r>1?r-1:0),c=1;c<r;c++)u[c-1]=arguments[c];return i.produce(n,(function(n){var r;return(r=e).call.apply(r,[t,n].concat(u))}))}}var u;if("function"!=typeof e&&f(6),void 0!==r&&"function"!=typeof r&&f(7),s(n)){var c=z(t),a=W(t,n,void 0),l=!0;try{u=e(a),l=!1}finally{l?A(c):C(c)}return"undefined"!=typeof Promise&&u instanceof Promise?u.then((function(n){return Z(c,r),I(n,c)}),(function(n){throw A(c),n})):(Z(c,r),I(u,c))}if(!n||"object"!=typeof n){if(void 0===(u=e(n))&&(u=n),u===J&&(u=void 0),t.F&&j(u,!0),r){var d=[],h=[];S("Patches").M(n,u,d,h),r(d,h)}return u}f(21,n)},this.produceWithPatches=function(n,e){if("function"==typeof n)return function(e){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(e,(function(t){return n.apply(void 0,[t].concat(o))}))};var r,o,i=t.produce(n,e,(function(n,t){r=n,o=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(n){return[n,r,o]})):[i,r,o]},"boolean"==typeof(null==n?void 0:n.useProxies)&&this.setUseProxies(n.useProxies),"boolean"==typeof(null==n?void 0:n.autoFreeze)&&this.setAutoFreeze(n.autoFreeze)}var t=n.prototype;return t.createDraft=function(n){s(n)||f(8),l(n)&&(n=K(n));var t=z(this),e=W(this,n,void 0);return e[G].C=!0,C(t),e},t.finishDraft=function(n,t){var e=(n&&n[G]).A;return Z(e,t),I(void 0,e)},t.setAutoFreeze=function(n){this.F=n},t.setUseProxies=function(n){n&&!$&&f(20),this.g=n},t.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var r=t[e];if(0===r.path.length&&"replace"===r.op){n=r.value;break}}e>-1&&(t=t.slice(e+1));var o=S("Patches").$;return l(n)?o(n,t):this.produce(n,(function(n){return o(n,t)}))},n}(),cn=new un,an=cn.produce,fn=(cn.produceWithPatches.bind(cn),cn.setAutoFreeze.bind(cn),cn.setUseProxies.bind(cn),cn.applyPatches.bind(cn),cn.createDraft.bind(cn),cn.finishDraft.bind(cn),an),ln=e(5033),sn=e(3950),dn=e(184);function hn(n){var t=n.onClick,e=n.refreshing;return(0,dn.jsx)(gn,{onClick:t,disabled:e,children:(0,dn.jsx)(sn.Z,{})})}var pn,vn,bn,yn,gn=i.Z.button(on||(on=(0,r.Z)(["\n  position: fixed;\n  @media (min-width: 500px) {\n    position: absolute;\n  }\n  bottom: 20px;\n  left: 20px;\n\n  padding: 5px;\n  width: 40px;\n  height: 40px;\n\n  overflow: hidden;\n  background: white;\n  border: 2px solid #eee;\n  border-radius: 100%;\n\n  ","\n  @keyframes rotation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  svg {\n    color: #aaa;\n    width: 100%;\n    height: 100%;\n  }\n"])),(function(n){return n.disabled&&"animation: 500ms rotation infinite linear;"})),mn=e(3329),xn=e(5879),wn=e(1833),jn=e(8141),kn=e(1098),Pn=300,Sn=function(n){return String(n).replace(/,/g,"")},On=function(n){return BigInt(Sn(n)).toLocaleString()},Zn=function(n){try{return"number"!==typeof n&&(BigInt(Sn(n)),!0)}catch(t){return!1}},An=function(n){if(n){var t=document.querySelector(".fakeInput");if(t){t.value=n.value,t.style.fontSize=getComputedStyle(n).fontSize,t.style.fontWeight=getComputedStyle(n).fontWeight;var e=t.scrollWidth+10;n.style.width=e+"px",t.value=""}}};function Cn(n){var t,e=n.sheetData,r=n.setSheetData,o=n.addRow,i=n.removeRow,c=BigInt(0);return(0,dn.jsx)(In,{children:(0,dn.jsx)("table",{children:(0,dn.jsxs)("tbody",{children:[(0,dn.jsxs)("tr",{children:[(0,dn.jsx)("th",{}),(0,dn.jsx)("th",{children:"\ubc88\ud638"}),(0,dn.jsx)("th",{children:"\uc720\ud615"}),(0,dn.jsx)("th",{children:"\ud56d\ubaa9"}),(0,dn.jsx)("th",{children:"\uac00\uaca9"}),(0,dn.jsx)("th",{children:"\ud569\uacc4"}),(0,dn.jsx)("th",{onClick:function(){return o(0)},children:(0,dn.jsx)(Rn,{fontSize:"small"})})]}),u.Children.toArray(null===e||void 0===e||null===(t=e.table)||void 0===t?void 0:t.map((function(n,t){return(0,dn.jsxs)("tr",{id:"row_".concat(t+1),children:[(0,dn.jsx)("td",{onClick:function(){i(t+1)},children:(0,dn.jsx)(Fn,{fontSize:"small"})}),(0,dn.jsx)("td",{children:t+1}),u.Children.toArray(n.map((function(n,o){return 2===o&&(c+=function(n){var t=Sn(n);return Zn(t)?BigInt(t):BigInt(0)}(n)),(0,dn.jsx)("td",{children:(0,dn.jsx)(_n,{numCheck:2===o,value:2===o&&Zn(n)&&""!==n?On(n):n.toString(),height:"28px",onChange:function(n){return function(n,t,o){if(n.target){An(n.target);var i=fn((function(e){if(e&&e.table&&e.table[t])return e.table[t][o]=n.target.value,e}),e);r(i)}}(n,t,o)}})})}))),(0,dn.jsx)("td",{children:On(c)}),(0,dn.jsx)("td",{onClick:function(){return o(t+1)},children:(0,dn.jsx)(Rn,{fontSize:"small"})})]})})))]})})})}var zn,Dn,In=i.Z.div(pn||(pn=(0,r.Z)(["\n  min-width: 100%;\n  max-width: 200%;\n  overflow: auto;\n\n  table {\n    border-collapse: collapse;\n    border: 1px solid ",";\n  }\n  th {\n    background: ",";\n  }\n  th,\n  td {\n    border: 1px solid ",";\n    white-space: pre;\n    text-align: left;\n    padding: 2px;\n    min-width: 10px;\n  }\n  .blink {\n    @keyframes blink {\n      0% {\n        background: ",";\n      }\n      100% {\n        background: white;\n      }\n    }\n    animation: blink ","ms;\n  }\n  .blinkRed {\n    @keyframes blinkRed {\n      0% {\n        background: red;\n      }\n      100% {\n        background: white;\n      }\n    }\n    animation: blinkRed ","ms;\n  }\n  th:nth-of-type(3),\n  th:nth-of-type(4),\n  th:nth-of-type(5),\n  th:nth-of-type(6) {\n    min-width: 60px;\n  }\n  td:nth-of-type(5) input,\n  td:nth-of-type(6) {\n    text-align: right;\n  }\n  td:nth-of-type(3),\n  td:nth-of-type(4),\n  td:nth-of-type(5) {\n    padding: 0;\n  }\n"])),wn.w.greenLine,wn.w.greenLine,wn.w.greenLine,wn.w.greenLine,Pn,Pn),Rn=(0,i.Z)(jn.Z)(vn||(vn=(0,r.Z)(["\n  color: #7c7;\n"]))),Fn=(0,i.Z)(kn.Z)(bn||(bn=(0,r.Z)(["\n  color: red;\n"]))),_n=i.Z.input(yn||(yn=(0,r.Z)(["\n  width: 100%;\n  min-width: 100%;\n  height: ",";\n  border: 0;\n  outline: none;\n  background: none;\n  font: inherit;\n  &:focus,\n  &:hover,\n  &:active {\n    background: ",";\n  }\n  ","\n"])),(function(n){var t=n.height;return t?"".concat(t):"100%"}),wn.w.greenLine,(function(n){var t=n.numCheck,e=n.value;return t&&!Zn(e)?"background: #fcc;":""})),En=!0;function Ln(){var n=(0,c.UO)(),t=(0,c.s0)(),e=(0,u.useState)(),r=(0,o.Z)(e,2),i=r[0],f=r[1],l=(0,u.useState)(!1),s=(0,o.Z)(l,2),d=s[0],h=s[1],p=(0,u.useState)(!1),v=(0,o.Z)(p,2),b=v[0],y=v[1],g=(0,u.useState)(),m=(0,o.Z)(g,2),x=m[0],w=m[1],j=(0,u.useState)(),k=(0,o.Z)(j,2),P=k[0],S=k[1],O=(0,xn.Z)({message:"\uc800\uc7a5 \uc644\ub8cc",duration:1500}),Z=O.SnackBar,A=O.openSnackBar,C=(0,xn.Z)({message:"\uc0c8\ub85c\uace0\uce68 \uc644\ub8cc",duration:1500}),z=C.SnackBar,D=C.openSnackBar,I=(0,u.useCallback)((function(){n.sheetId&&(h(!0),(0,ln.zf)(Number(n.sheetId)).then((function(n){h(!1),n&&f(n)})))}),[n.sheetId]),R=(0,u.useCallback)((function(n){if(i){var t=fn((function(t){if(t)return An(n.target),t.name=n.target.value,t}),i);f(t)}}),[i]),F=(0,u.useCallback)((function(){var n=document.querySelectorAll("input:not(.fakeInput)");n&&(n.forEach((function(n){An(n)})),En=!1)}),[]);(0,u.useEffect)((function(){I()}),[I]),(0,u.useEffect)((function(){En&&i&&F()}),[F,i]),(0,u.useEffect)((function(){if(void 0!==x){var n=document.querySelector("#row_".concat(x+1));n&&(n.classList.add("blink"),w(void 0),setTimeout((function(){n.classList.remove("blink")}),Pn))}}),[x]),(0,u.useEffect)((function(){if(i&&void 0!==P){var n=document.querySelector("#row_".concat(P));n&&(n.classList.add("blinkRed"),setTimeout((function(){n.classList.remove("blinkRed");var t=fn(i,(function(n){var t;null===n||void 0===n||null===(t=n.table)||void 0===t||t.splice(P-1,1)}));f(t),S(void 0)}),Pn))}}),[P,i]);var _=(0,u.useCallback)((function(n){var t=fn(i,(function(t){var e;null===t||void 0===t||null===(e=t.table)||void 0===e||e.splice(n,0,["","",""])}));f(t),w(n)}),[i]),E=(0,u.useCallback)((function(n){S(n)}),[]);return(0,dn.jsxs)(dn.Fragment,{children:[(0,dn.jsx)(a.Z,{title:null!==i&&void 0!==i&&i.name?(0,dn.jsx)(Bn,{value:null===i||void 0===i?void 0:i.name,onChange:R}):null,backButton:!0,backFunction:function(){return t("/")}}),(0,dn.jsx)(Cn,{sheetData:i,setSheetData:f,addRow:_,removeRow:E}),(0,dn.jsx)(hn,{refreshing:d,onClick:function(){I(),D(),En=!0}}),(0,dn.jsx)(Mn,{disabled:b,onClick:function(){n.sheetId&&i&&(y(!0),(0,ln.w1)(Number(n.sheetId),i).then((function(n){y(!1),A()})))},children:(0,dn.jsx)(mn.Z,{})}),(0,dn.jsx)(z,{}),(0,dn.jsx)(Z,{})]})}var Bn=i.Z.input(zn||(zn=(0,r.Z)(["\n  width: 100%;\n  min-width: 100%;\n  height: 24px;\n  border: 0;\n  outline: none;\n  background: none;\n  font: inherit;\n  &:focus,\n  &:hover,\n  &:active {\n    border-bottom: 1px solid ",";\n  }\n"])),wn.w.greenLine),Mn=i.Z.button(Dn||(Dn=(0,r.Z)(["\n  position: fixed;\n  @media (min-width: 500px) {\n    position: absolute;\n  }\n  z-index: 1;\n  top: 2px;\n  right: 20px;\n\n  padding: 5px;\n  width: 40px;\n  height: 40px;\n\n  overflow: hidden;\n  background: blue;\n  border: 2px solid #eee;\n  border-radius: 100%;\n  opacity: 0.7;\n  svg {\n    color: white;\n    width: 100%;\n    height: 100%;\n  }\n  ","\n"])),(function(n){return n.disabled&&"background: #555;"}))},8141:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(5649)),i=e(184),u=(0,o.default)((0,i.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutline");t.Z=u},3950:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(5649)),i=e(184),u=(0,o.default)((0,i.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");t.Z=u},3329:function(n,t,e){var r=e(4836);t.Z=void 0;var o=r(e(5649)),i=e(184),u=(0,o.default)((0,i.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.Z=u}}]);
//# sourceMappingURL=377.a304806a.chunk.js.map